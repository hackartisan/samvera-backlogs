Replacing MAP with a data-mapper pattern
