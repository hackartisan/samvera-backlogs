Adding support for suppressDiscovery restriction
Fixes https://lib-jira.ucsd.edu:8443/browse/DHH-670