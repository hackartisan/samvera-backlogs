reworks HTTP header based API authentication
fixes #1603