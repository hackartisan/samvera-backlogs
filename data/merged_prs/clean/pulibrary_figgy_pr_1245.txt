Refactoring around enqueued jobs in specs
fixes #1042