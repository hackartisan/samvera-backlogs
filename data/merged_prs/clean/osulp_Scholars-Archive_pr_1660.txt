Update to work with string and nested object
Fixes #1659