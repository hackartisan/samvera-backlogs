Feature/triple powered refactor
Fixes #704