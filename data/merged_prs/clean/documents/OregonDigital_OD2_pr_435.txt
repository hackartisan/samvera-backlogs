move duped code to base object
Fixes #408