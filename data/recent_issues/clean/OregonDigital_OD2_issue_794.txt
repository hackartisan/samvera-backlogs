institution issue on CreateDerivativesJob
Descriptive summary institution: CreateDerivativesJob fails with undefined method language in  [ActiveJob] [CreateDerivativesJob] [60314266-d8a5-4943-951c-27662f457546] Error performing CreateDerivativesJob (Job ID: 60314266-d8a5-4943-951c-27662f457546) from Sidekiq(default) in 7304.95ms: NoMethodError (undefined method `language' for "":String): /data/lib/oregon_digital/controlled_vocabularies/institution.rb:17:in `block in solrize'  It looks like we can fix with a try method: diff --git a/lib/oregon_digital/controlled_vocabularies/institution.rb b/lib/oregon_digital/controlled_vocabularies/institution.rb index 10ca62a..b96efcf 100644 --- a/lib/oregon_digital/controlled_vocabularies/institution.rb +++ b/lib/oregon_digital/controlled_vocabularies/institution.rb @@ -14,7 +14,7 @@ module OregonDigital         # Return a tuple of url & label        def solrize -        label = rdf_label.select { |lang_label| lang_label.language == I18n.locale }.first +        label = rdf_label.select { |lang_label| lang_label.try(:language) == I18n.locale }.first          return [rdf_subject.to_s] if label.to_s.blank? || rdf_label_uri_same?           [rdf_subject.to_s, { label: "#{label}$#{rdf_subject}" }] @@ -23,7 +23,7 @@ module OregonDigital        private         def rdf_label_uri_same? -        rdf_label.select { |lang_label| lang_label.language == I18n.locale }.first.to_s == rdf_subject.to_s +        rdf_label.select { |lang_label| lang_label.try(:language) == I18n.locale }.first.to_s == rdf_subject.to_s        end      end    end